<!DOCTYPE html>
<html class="loading" dir="ltr" lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>8.2.3.1 Configuring a Router as a Stateful DHCPv6 Server</title>
    <!-- Content -->
    <link rel="stylesheet" type="text/css" href="../../common-ext/styles/page.css"/>
    <script type="text/javascript" src="../../common-ext/scripts/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/permission.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/page.js"></script>
    <script type="text/javascript" src="media/override.js"></script>
    <script>
      var media_transcript_file = "media_8.2.3.1_longdesc.txt";
    </script>
  </head>
  <body>
    <div id="text-container" role="main">
      <div id="text">
        <h1>Configuring a Router as a Stateful DHCPv6 Server</h1>
        <div>
          <p>Configuring a stateful DHCPv6 server is similar to configuring a stateless server. The most significant difference is that a stateful server also includes IPv6 addressing information similar to a DHCPv4 server. </p>
          <p></p>
          <p>
            <b>Step 1. Enable IPv6 Routing </b>
          </p>
          <p></p>
          <p>As shown in Figure 1, the<b> ipv6 unicast-routing </b>command is required to enable IPv6 routing. This command is not necessary for the router to be a stateful DHCPv6 server, but it is required for the router to source ICMPv6 RA messages. </p>
          <p></p>
          <p>
            <b>Step 2.</b>
            <b>Configure a DHCPv6 Pool</b>
          </p>
          <p></p>
          <p>The<b> ipv6 dhcp pool </b><i>pool-name </i>command creates a pool and enters the router in DHCPv6 configuration mode, which is identified by the Router(config-dhcpv6)# prompt.</p>
          <p></p>
          <p>
            <b>Step 3.</b>
            <b>Configure Pool Parameters</b>
          </p>
          <p></p>
          <p>With stateful DHCPv6 all addressing and other configuration parameters must be assigned by the DHCPv6 server. The<b> address prefix </b>command is used to indicate the pool of addresses to be allocated by the server. The<b> lifetime </b>option indicates the valid and preferred lease times in seconds. As with stateless DHCPv6, the client uses the source IPv6 address from the packet that contained the RA message.</p>
          <p></p>
          <p>Other information provided by the stateful DHCPv6 server typically includes DNS server address and the domain name.</p>
          <p></p>
          <p>
            <b>Step 4. Interface Commands</b>
          </p>
          <p></p>
          <p>The<b> ipv6 dhcp server </b><i>pool-name </i>interface command binds the DHCPv6 pool to the interface. The router responds to stateless DHCPv6 requests on this interface with the information contained in the pool. The M flag needs to be changed from 0 to 1 using the interface command<b> ipv6 nd managed-config-flag</b>. This informs the device not to use SLAAC but to obtain IPv6 addressing and all configuration parameters from a stateful DHCPv6 server.</p>
          <p></p>
          <p>
            <b>DHCPv6 Stateful Server Example</b>
          </p>
          <p></p>
          <p>Figure 2 shows an example of stateful DHCPv6 server commands for a router configured on R1. Notice that a default gateway is not specified because the router will automatically send its own link-local address as the default gateway. Router R3 is configured as a client to help verify the stateful DHCPv6 operations. </p>
        </div>
      </div>
      <div id="text-handle" title="Resize" role="button"></div>
    </div>
    <div id="media-container" role="complementary">
      <iframe id="media" title="interactive graphic" aria-label="interactive graphic" aria-describedby="media-description"></iframe>
      <div id="media-description">Figure one shows the commands used to configure a stateful d.h.c.p.v.6. router.  The first command is, i.p.v.6. unicast hyphen routing.  Next, the pool is created with the command, i.p.v.6. d.h.c.p. pool, and then the pool name follows.  The next command is, address prefix slash. This is followed by the prefix length.  The d.n.s. server is configured with the command, d.n.s. hyphen server, followed by the address.  The domain name can also be configured with the command, domain hyphen name, followed by the domain name.  The next command binds the d.h.c.p.v.6. pool to an interface. The command is, i.p.v.6. d.h.c.p. server, followed by the pool name.  The last command is, i.p.v.6. n.d. managed hyphen config hyphen flag. Figure two shows a full example of configuring a router as a stateful d.h.c.p.v.6. server.  The example begins in global configuration mode and the commands used are as follows.  The first command is, i.p.v.6. unicast hyphen routing.  The next command is, d.h.c.p. pool i.p.v.6. hyphen stateful.  The next command is, address prefix 2 0 0 1 colon d b 8 colon c a f e colon 1 colon colon slash 64 lifetime infinite.  The next command is, d.n.s. hyphen server 2 0 0 1 colon d b 8 colon c a f e colon a a a a colon colon 5.  The next command is, domain hyphen name example dot com.  The d.h.c.p.v.6. pool has been configured and the next set of commands bind the pool to the interface.  The C.L.I. in the example moves to the local interface first with the command, exit. The exit command is followed by the command, interface g zero slash one.  The next command is, i.p.v.6. address 2 0 0 1 colon d b 8 colon c a f e colon 1 colon colon 1 slash 64.  The next command is, d.h.c.p. pool i.p.v.6.  hyphen stateful .  The last command is, i.p.v.6. n.d. managed hyphen config hyphen flag.</div>
    </div>
    <div id="login">Please log into <a href="http://netacad.com">netacad.com</a> before accessing this course.</div>
  </body>
</html>
